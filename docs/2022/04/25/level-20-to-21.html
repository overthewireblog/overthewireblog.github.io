<!doctype html>
<html>
  <head>
  <meta charset="utf-8">
  <title>Level 20 To 21</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
  <link rel="stylesheet" href="/assets/css/styles.css">
</head>

<!-- Insert google analytics here -->
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6G08EX2H2Q"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-6G08EX2H2Q');
</script>

  <body>

      <nav class="navbar navbar-expand-lg bg-body-tertiary">
  <div class="container-fluid">
    <a class="navbar-brand" href="#">OTW</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <!-- <li class="nav-item">
          <a class="nav-link active" aria-current="page" href="#">Home</a>
        </li> -->
        
        <li class="nav-item">
          <a class ="nav-link" href="/" >home</a>
        </li>
        
        <li class="nav-item">
          <a class ="nav-link" href="/about.html" >about</a>
        </li>
        
        <li class="nav-item">
          <a class ="nav-link" href="/blog.html" >blog</a>
        </li>
        
        <!-- <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            Dropdown
          </a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="#">Action</a></li>
            <li><a class="dropdown-item" href="#">Another action</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item" href="#">Something else here</a></li>
          </ul>
        </li> -->
        <!-- <li class="nav-item">
          <a class="nav-link disabled">Disabled</a>
        </li> -->
      </ul>
      <form class="d-flex" role="search">
        <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
        <button class="btn btn-outline-success" type="submit">Search</button>
      </form>
    </div>
  </div>
</nav>


    <div class="container">
      <div class="row">
            <div class="col">
              <h1>Level 20 To 21</h1>
<p>25 Apr 2022 - mike</p>

<h3 id="level-20---21">Level 20 -&gt; 21</h3>
<h4 id="game-instructions">Game Instructions</h4>
<blockquote>
  <p>There is a setuid binary in the homedirectory that does the following: it makes a connection to localhost on the port you specify as a commandline argument. It then reads a line of text from the connection and compares it to the password in the previous level (bandit20). If the password is correct, it will transmit the password for the next level (bandit21).</p>
</blockquote>

<p>First we send the string of the last password to a TCP server running on a port of our choice (in this exampe <strong>61137</strong>).
<code class="language-plaintext highlighter-rouge">echo "GbKksEFF4yrVs6il55v6gwY5aVje5f0j" | nc -l localhost -p 61137 &amp;</code></p>

<p>Then we check to make sure itâ€™s working</p>

<p><code class="language-plaintext highlighter-rouge">ps aux</code></p>

<p><code class="language-plaintext highlighter-rouge">USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
bandit20   658  0.0  0.1  21148  5144 pts/54   Ss   17:22   0:00 -bash
bandit20  1103  0.0  0.1  21148  4860 pts/35   Ss+  16:36   0:00 -bash
bandit20  1157  0.0  0.0   6300  1584 pts/39   S+   16:36   0:00 nc -l localhost
bandit20  1523  0.0  0.0   6300  1660 pts/54   S    17:24   0:00 nc -l localhost
bandit20  1696  0.0  0.0  19188  2372 pts/54   R+   17:24   0:00 ps aux
bandit20 31119  0.0  0.1  21148  4968 pts/39   Ss   16:32   0:00 -bash
</code></p>

<p>We can see that it is running on process ID <strong>1523</strong></p>

<p>No we can run the binary to ask the server to send us the next one:</p>

<p><code class="language-plaintext highlighter-rouge">./suconnect 61137</code></p>

<p>Next password:
<code class="language-plaintext highlighter-rouge">gE269g2h3mw3pwgrj0Ha9Uoqen1c9DGr</code></p>



<div class="post-nav">
  <div>
    
      <a href="/2022/04/22/leve-19-to-20.html">
        <span class="unsighted">Previous post:</span>
        <span aria-hidden="true">&laquo;</span>
        Leve 19 To 20
      </a>
    
  </div>
  <div class="post-nav-next">
    
    
    
    
    
    <a href="/2022/04/27/level-21-to-22.html">
      <span class="unsighted">Next post:</span>
      Level 21 To
      <span style="white-space: nowrap;">
      22
      <span aria-hidden="true">&raquo;</span>
      </span>
    </a>
    
  </div>
</div>

            </div>
        <div class="col">
          <div class="card">
            <div class="card-body">
              <div class="container">
<p>Sidebar</p>

<h4>Bandit</h4>
<ul>


  <li>
    <a href="/2022/05/30/level-32-to-33.html">Level 32 To 33</a>
  </li>


  <li>
    <a href="/2022/05/28/level-31-to-32.html">Level 31 To 32</a>
  </li>


  <li>
    <a href="/2022/05/25/level-30-to-31.html">Level 30 To 31</a>
  </li>


  <li>
    <a href="/2022/05/22/level-29-to-30.html">Level 29 To 30</a>
  </li>


  <li>
    <a href="/2022/05/15/level-28-to-29.html">Level 28 To 29</a>
  </li>


  <li>
    <a href="/2022/05/13/level-27-to-28.html">Level 27 To 28</a>
  </li>


  <li>
    <a href="/2022/05/12/level-26-tp-27.html">Level 26 Tp 27</a>
  </li>


  <li>
    <a href="/2022/05/11/level-25-to-26.html">Level 25 To 26</a>
  </li>


  <li>
    <a href="/2022/05/03/level-24-to-25.html">Level 24 To 25</a>
  </li>


  <li>
    <a href="/2022/05/02/level-23-to-24.html">Level 23 To 24</a>
  </li>


  <li>
    <a href="/2022/04/30/level-22-to-23.html">Level 22 To 23</a>
  </li>


  <li>
    <a href="/2022/04/27/level-21-to-22.html">Level 21 To 22</a>
  </li>


  <li>
    <a href="/2022/04/25/level-20-to-21.html">Level 20 To 21</a>
  </li>


  <li>
    <a href="/2022/04/22/leve-19-to-20.html">Leve 19 To 20</a>
  </li>


  <li>
    <a href="/2022/04/15/level-18-to-19.html">Level 18 To 19</a>
  </li>


  <li>
    <a href="/2022/04/11/level-17-to-18.html">Level 17 To 18</a>
  </li>


  <li>
    <a href="/2022/04/09/level-16-to-17.html">Level 16 To 17</a>
  </li>


  <li>
    <a href="/2022/04/07/level-15-to-16.html">Level 15 To 16</a>
  </li>


  <li>
    <a href="/2022/04/05/level-14-to-15.html">Level 14 To 15</a>
  </li>


  <li>
    <a href="/2022/04/04/level-13-to-14.html">Level 13 To 14</a>
  </li>


  <li>
    <a href="/2022/04/03/level-12-to-13.html">Level 12 To 13</a>
  </li>


  <li>
    <a href="/2022/04/02/level-11-to-12.html">Level 11 To 12</a>
  </li>


  <li>
    <a href="/2022/03/21/level-10-to-11.html">Level 10 To 11</a>
  </li>


  <li>
    <a href="/2022/03/20/level-9-to-10.html">Level 9 To 10</a>
  </li>


  <li>
    <a href="/2022/03/18/level-8-to-9.html">Level 8 To 9</a>
  </li>


  <li>
    <a href="/2022/03/17/level-7-to-8.html">Level 7 To 8</a>
  </li>


  <li>
    <a href="/2022/03/16/level-6-to-7.html">Level 6 To 7</a>
  </li>


  <li>
    <a href="/2022/03/15/level-5-to-6.html">Level 5 To 6</a>
  </li>


  <li>
    <a href="/2022/03/13/level-4-to-5.html">Level 4 To 5</a>
  </li>


  <li>
    <a href="/2022/03/11/level-3-to-4.html">Level 3 To 4</a>
  </li>


  <li>
    <a href="/2022/03/03/level-2-to-3.html">Level 2 To 3</a>
  </li>


  <li>
    <a href="/2022/03/01/level-1-to-2.html">Level 1 To 2</a>
  </li>


  <li>
    <a href="/2022/02/12/level-0-to-1.html">Level 0 To 1</a>
  </li>


  <li>
    <a href="/2022/02/01/level-0.html">Level 0</a>
  </li>

</ul>
</div>

            </div>
          </div>
        </div>
      </div>
    </div>
  <p>footer</p>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>

  </body>
</html>
